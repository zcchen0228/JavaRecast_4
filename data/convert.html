<html>
<head><title>Annotation to Start/End</title></head>
<body>
<textarea id="inputArea">
1,0,10.055167214413688,3.248410343993622
1,500,10.032203894236803,2.922244439513193
1,1000,10.05194620465493,2.4837246227747505
1,1500,9.891165350438493,2.1070247697412996
1,2000,9.68534911431812,1.7830193510840102
1,2500,9.617913058880417,1.5268890215215247
1,3000,9.580963926150023,1.2727311563320378
1,3500,9.417685344841365,0.8716890468732178
1,4000,9.3928201543866,0.5006684414643834
1,4500,9.386811334044616,0.26677660389310776
1,5000,9.241488547075354,-3.345228054741692e-4
1,5500,9.190034138015447,-0.19958503027060562
1,6000,9.13694158025031,-0.4586779140911142
1,6500,9.038274096852277,-0.6834820846548432
1,7000,8.888486250643442,-1.0709972146746187
1,7500,8.80155038870142,-1.4142314162170802
1,8000,8.683663567352937,-1.7418843280584326
1,8500,8.596158478288533,-2.087163736778847
1,9000,8.572776165865193,-2.367037671209905
1,9500,8.534773187978688,-2.609271424252611
1,10000,8.557842975320597,-2.904835575442854
1,10500,8.5321479092222,-3.266040702404658
1,11000,8.521573785126572,-3.6462575952890517
1,11500,8.53007057966538,-3.905019436641312
1,12000,8.459215839118533,-4.193592268236833
1,12500,8.434999601403758,-4.497251820292921
1,13000,8.501583278129619,-4.93094963002068
1,13500,8.602061239419493,-5.280418409124701
1,14000,8.721107812540508,-5.526954644885666
1,14500,8.821113377046375,-5.896859315685777
1,15000,8.874432530967697,-6.253051115769218
2,0,7.0510741833287875,-6.108553673981282
2,500,7.01813272658115,-6.133278192025659
2,1000,7.01813272658115,-6.133278192025659
2,1500,7.01813272658115,-6.133278192025659
2,2000,7.031680245651374,-6.213153631198853
2,2500,6.998068328904023,-6.258427210211315
2,3000,6.994152747332911,-6.381541726362429
2,3500,6.9740618659211115,-6.50690003360688
2,4000,6.969480338417414,-6.650752999221488
2,4500,6.949361484230162,-6.776337394414727
</textarea>
<button onclick="convert()">Convert</button>
<textarea id="outputArea">

</textarea>
<script src='https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js'></script>

<script>
    function convert() {
      const input = document.getElementById("inputArea").value;


      const allLines = input.split("\n");
      const allEntries = [];
      for(let i = 0; i < allLines.length; i++)
      {
        let entries = allLines[i].split(",");
        allEntries.push([]);
        for(let j = 0; j < entries.length; j++)
        {
          allEntries[i].push(parseFloat(entries[j].trim()));
        }
      }

      //Now get each agent number and get its starting time, starting xy and ending xy
        let agentNumbers = _.uniqBy(allEntries, e=>e[0]);

      let toReturn = "";

      for(let i = 0; i < agentNumbers.length; i++)
      {
        let agentID = agentNumbers[i][0];
        if(!agentID && agentID!==0) break;
        let earliest = _(allEntries).filter(e=>e[0] === agentID).sortBy(e=>e[1]).value()[0];
        let latest = _(allEntries).filter(e=>e[0] === agentID).sortBy(e=>-e[1]).value()[0];
        toReturn += agentID + "," + earliest[1] + "," + earliest[2] + ",0.318021446," + earliest[3] + "," + latest[2] + ",0.318021446," + latest[3] + "\r\n";
      }

      console.log(agentNumbers.length);


      document.getElementById("outputArea").value = toReturn;
    }

</script>
</body>
</html>